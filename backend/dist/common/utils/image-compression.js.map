{"version":3,"sources":["../../../src/common/utils/image-compression.ts"],"sourcesContent":["import * as fs from 'fs';\nimport * as sharp from 'sharp';\n\nexport async function compressImage(\n  path: string,\n  mimetype: string,\n): Promise<void> {\n  const sharpInstance = sharp(path);\n\n  let buffer: Buffer;\n  if (mimetype === 'image/jpeg') {\n    buffer = await sharpInstance.jpeg({ quality: 70 }).toBuffer();\n  } else if (mimetype === 'image/png') {\n    buffer = await sharpInstance.png({ compressionLevel: 8 }).toBuffer();\n  } else {\n    return;\n  }\n\n  await fs.promises.writeFile(path, buffer);\n}\n"],"names":["compressImage","path","mimetype","sharpInstance","sharp","buffer","jpeg","quality","toBuffer","png","compressionLevel","fs","promises","writeFile"],"mappings":";;;;+BAGsBA;;;eAAAA;;;4DAHF;+DACG;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAEhB,eAAeA,cACpBC,IAAY,EACZC,QAAgB;IAEhB,MAAMC,gBAAgBC,OAAMH;IAE5B,IAAII;IACJ,IAAIH,aAAa,cAAc;QAC7BG,SAAS,MAAMF,cAAcG,IAAI,CAAC;YAAEC,SAAS;QAAG,GAAGC,QAAQ;IAC7D,OAAO,IAAIN,aAAa,aAAa;QACnCG,SAAS,MAAMF,cAAcM,GAAG,CAAC;YAAEC,kBAAkB;QAAE,GAAGF,QAAQ;IACpE,OAAO;QACL;IACF;IAEA,MAAMG,IAAGC,QAAQ,CAACC,SAAS,CAACZ,MAAMI;AACpC"}