{"version":3,"sources":["../../../../src/modules/auth/controller/auth.controller.ts"],"sourcesContent":["import { Body, Controller, Post, Req, UseGuards } from '@nestjs/common';\nimport { CommandBus } from '@nestjs/cqrs';\nimport { ApiBearerAuth, ApiTags } from '@nestjs/swagger';\nimport { OTPVerifyAuthGuard } from 'src/common/shared/guards/verify-auth.guard';\nimport { RequestWithOTP } from 'src/common/shared/interface/response';\nimport { LoginCommand } from '../command/login/login-command';\nimport { RegistrationCommand } from '../command/registration/registration-command';\nimport { VerifyRegistrationCommand } from '../command/verification/verify-registration-command';\nimport { LoginAuthDto } from '../dto/login-auth.dto';\nimport { RegistrationAuthDto } from '../dto/registration-auth.dto';\nimport { VerifyRegistrationAuthDto } from '../dto/verify-registration-auth.dto';\n\n@Controller('auth')\n@ApiTags('Authentication and Authorization')\nexport class AuthController {\n  constructor(private readonly commandBus: CommandBus) {}\n\n  @Post('v1/clerk')\n  async authClerk() {\n    return 'authClerk';\n  }\n\n  @Post('v1/registration')\n  async authRegistration(@Body() registrationAuthDto: RegistrationAuthDto) {\n    return await this.commandBus.execute(\n      new RegistrationCommand(registrationAuthDto),\n    );\n  }\n\n  @Post('v1/registration/verify')\n  @ApiBearerAuth()\n  @UseGuards(OTPVerifyAuthGuard)\n  async authRegistrationVerify(\n    @Body() verifyRegistrationAuthDto: VerifyRegistrationAuthDto,\n    @Req() req: RequestWithOTP,\n  ) {\n    return await this.commandBus.execute(\n      new VerifyRegistrationCommand(verifyRegistrationAuthDto, req.user),\n    );\n  }\n\n  @Post('v1/login')\n  async authLogin(@Body() loginAuthDto: LoginAuthDto) {\n    return await this.commandBus.execute(new LoginCommand(loginAuthDto));\n  }\n}\n"],"names":["AuthController","authClerk","authRegistration","registrationAuthDto","commandBus","execute","RegistrationCommand","authRegistrationVerify","verifyRegistrationAuthDto","req","VerifyRegistrationCommand","user","authLogin","loginAuthDto","LoginCommand","constructor"],"mappings":";;;;+BAcaA;;;eAAAA;;;wBAd0C;sBAC5B;yBACY;iCACJ;0BACJ;8BACF;qCACO;2CACM;8BACb;qCACO;2CACM;;;;;;;;;;;;;;;AAInC,IAAA,AAAMA,iBAAN,MAAMA;IAGX,MACMC,YAAY;QAChB,OAAO;IACT;IAEA,MACMC,iBAAiB,AAAQC,mBAAwC,EAAE;QACvE,OAAO,MAAM,IAAI,CAACC,UAAU,CAACC,OAAO,CAClC,IAAIC,wCAAmB,CAACH;IAE5B;IAEA,MAGMI,uBACJ,AAAQC,yBAAoD,EAC5D,AAAOC,GAAmB,EAC1B;QACA,OAAO,MAAM,IAAI,CAACL,UAAU,CAACC,OAAO,CAClC,IAAIK,oDAAyB,CAACF,2BAA2BC,IAAIE,IAAI;IAErE;IAEA,MACMC,UAAU,AAAQC,YAA0B,EAAE;QAClD,OAAO,MAAM,IAAI,CAACT,UAAU,CAACC,OAAO,CAAC,IAAIS,0BAAY,CAACD;IACxD;IA7BAE,YAAY,AAAiBX,UAAsB,CAAE;aAAxBA,aAAAA;IAAyB;AA8BxD"}